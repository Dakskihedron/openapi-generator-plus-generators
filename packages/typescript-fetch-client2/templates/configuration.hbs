{{>header}}

import { BASE_PATH, FetchAPI, defaultFetch } from "./runtime";

export interface ConfigurationParameters {
	apiKey?: string | ((name: string) => string | null);
	username?: string;
	password?: string;
	authorization?: string | ((name: string, scopes?: string[]) => string | null);
	basePath?: string;
	fetch?: FetchAPI;
}

export class Configuration {
	/**
	 * parameter for apiKey security
	 * @param name security name
	 * @memberof Configuration
	 */
	apiKey?: string | ((name: string) => string | null);
	/**
	 * parameter for basic security
	 * 
	 * @type {string}
	 * @memberof Configuration
	 */
	username?: string;
	/**
	 * parameter for basic security
	 * 
	 * @type {string}
	 * @memberof Configuration
	 */
	password?: string;
	/**
	 * parameter for oauth2, openIdConnect or http security
	 * @param name security name
	 * @param scopes oauth2 scopes
	 * @memberof Configuration
	 */
	authorization?: string | ((name: string, scopes?: string[]) => string | null);
	/**
	 * override base path
	 * 
	 * @type {string}
	 * @memberof Configuration
	 */
	basePath: string;
	/**
	 * The fetch function to use when making requests from the API.
	 * 
	 * @type {FetchAPI}
	 * @memberof Configuration
	 */
	fetch: FetchAPI;

	constructor(param: ConfigurationParameters = {}) {
		this.apiKey = param.apiKey;
		this.username = param.username;
		this.password = param.password;
		this.authorization = param.authorization;
		this.basePath = param.basePath ?? BASE_PATH;
		this.fetch = param.fetch ?? defaultFetch;
	}
}

let globalConfiguration = new Configuration();

export function setGlobalConfiguration(configuration: Configuration) {
	globalConfiguration = configuration;
}

export function getGlobalConfiguration(): Configuration {
	return globalConfiguration;
}
